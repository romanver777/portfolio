"use strict";!function(){var e,o,r=document.querySelector(".preloader"),i=document.querySelector(".preloader-bg"),c=document.querySelector(".container-index"),t=["./assets/img/content/forest_prel_bg.jpg"],s=["./assets/js/foundation.js"],a=["./assets/img/content/bg_forest_1800.jpg","./assets/img/content/water-maps.jpg"],u=0,l=0,d=!m()&&1200<=window.innerWidth?[].concat(t,s,a).length:t.length+1;function m(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||"ontouchstart"in document.documentElement}function f(e){var t=document.querySelector(".progress__number"),n=100*e/d,e=Math.round(10/d);o&&clearInterval(o),o=setInterval(function(){n<=(u+=1)&&(clearInterval(o),u=n),t.innerHTML=u},e)}function _(){var e,t,n;location.toString().includes("auth")&&(e=document.querySelector(".auth-wrap"),t=document.querySelector(".front"),n=document.querySelector(".back"),t.classList.add("front_flipped"),n.classList.add("back_flipped"),e.classList.add("auth-wrap_display-none")),setTimeout(function(){c.classList.add("container-index_visible"),r.classList.add("preloader_hided")},1e3)}t=t,(e=new Image).src=t[0],e.onload=function(){var e,t,n;f(++l),i.classList.add("preloader-bg_visible"),!m()&&1200<=window.innerWidth?Promise.all(s.map(function(e){return n=e,new Promise(function(e){var t=document.createElement("script");t.src=n,document.head.append(t),t.onload=function(){f(++l),e()}});var n})).then(function(){return Promise.all(a.map(function(e){return n=e,new Promise(function(e){var t=new Image;t.src=n,t.onload=function(){f(++l),e()}});var n}))}).then(function(){l===d&&(c.classList.remove("bg-forest-index"),_())}):(e=document.querySelector(".bg-forest-index"),t='url("',t=(e=window.getComputedStyle(e).backgroundImage).indexOf(t)+t.length,(n=new Image).src=e.slice(t,-'")'.length),n.onload=function(){f(++l),_()})}}(),function(){var t=document.querySelector(".auth-wrap"),e=document.querySelector(".auth__link"),n=document.querySelector(".front"),o=document.querySelector(".back"),r=document.querySelector(".butt__link_home");e.addEventListener("click",function(){n.classList.add("front_flipped"),o.classList.add("back_flipped"),t.classList.add("auth-wrap_display-none")}),r.addEventListener("click",function(e){e.preventDefault(),n.classList.remove("front_flipped"),o.classList.remove("back_flipped"),t.classList.remove("auth-wrap_display-none")})}(),function(){var t,e=document.querySelector(".butt__link_login"),a=document.querySelector(".form__name"),u=document.querySelector(".form__pass"),l=document.querySelector(".checkbox__input"),d=document.querySelector(".radio-btn__input_yes"),m=document.querySelector(".messageBox"),f=document.querySelector(".messageBox__text"),_=document.querySelector(".form-auth");e.addEventListener("click",function(e){var n,o,r,i,c,s;e.preventDefault(),Promise.all([(e=a.value,c=/^[a-zA-Z0-9]+$/,s=e.trim(),new Promise(function(e,t){return c.test(s)&&2<s.length?e(s):t("Введите логин длиной от ".concat(3," символов"))})),(e=u.value,r=[4,15],i=e.trim(),new Promise(function(e,t){return i.length>r[0]&&i.length<=r[1]?e(i):t("Введите пароль длиной от ".concat(r[0]+1," до ").concat(r[1]," символов"))})),(o=l,new Promise(function(e,t){return o.checked?e():t("Роботам вход воспрещен")})),(n=d,new Promise(function(e,t){return n.checked?e():t("Роботам вход воспрещен")}))]).then(function(){clearTimeout(t),m.classList.remove("messageBox_visible"),setTimeout(function(){f.innerHTML="Форма отправлена",m.classList.add("messageBox_visible"),_.reset()},800),setTimeout(function(){m.classList.remove("messageBox_visible")},3e3)}).catch(function(e){t?(clearTimeout(t),m.classList.remove("messageBox_visible"),setTimeout(function(){f.innerHTML=e,m.classList.add("messageBox_visible")},800)):(f.innerHTML=e,m.classList.add("messageBox_visible")),t=setTimeout(function(){m.classList.remove("messageBox_visible"),t=null},3e3)})})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiaW1hZ2UiLCJpbnRJZCIsInByZUxvYWRlciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInByZUxvYWRlckJnIiwibG9hZGVyVXJsIiwic2NyaXB0VXJsIiwicGFnZUltZ1VybHMiLCJwcm9ncmVzcyIsImNoZWNrTG9hZGluZ0JnUHJlbG9hZGVyIiwibG9hZGVkIiwiaXNNb2JpbGUiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiYW5pbWF0ZVByb2dyZXNzIiwibGVuZ3RoIiwiY2xhc3NMaXN0IiwidGVzdCIsImRvY3VtZW50RWxlbWVudCIsImNvdW50IiwiZWxlbSIsImlubmVySFRNTCIsInRpbWUiLCJtYXhMb2FkZWQiLCJhdXRoV3JhcCIsIk1hdGgiLCJiYWNrIiwiZnJvbnQiLCJhZGQiLCJzZXRJbnRlcnZhbCIsIm5ld051bWJlciIsIm9wZW5BdXRoUGFnZSIsImxvY2F0aW9uIiwidG9TdHJpbmciLCJzZXRUaW1lb3V0IiwiYXV0aExpbmsiLCJpbmNsdWRlcyIsImhvbWVMaW5rIiwiYWRkRXZlbnRMaXN0ZW5lciIsInByZXZlbnREZWZhdWx0IiwidXJsIiwiY3JlYXRlRWxlbWVudCIsImxvYWRTY3JpcHQiLCJzcmMiLCJvbmxvYWQiLCJQcm9taXNlIiwiY29udGFpbmVySW5kZXgiLCJzaG93UGFnZSIsIm1hcCIsInNjcmlwdCIsInJlcyIsImltZyIsImFwcGVuZCIsInRoZW4iLCJhbGwiLCJpbnRlcnZhbCIsIkltYWdlIiwic3RlcCIsImNsZWFySW50ZXJ2YWwiLCJyZW1vdmUiLCJmaXJzdEl0ZW0iLCJiZyIsImJnU3R5bGUiLCJzbGljZSIsImxhc3RJdGVtIiwiaW5kZXhPZiIsImluZGV4IiwibG9naW5MaW5rIiwiZm9ybU5hbWUiLCJmb3JtUGFzcyIsImNoZWNrYm94IiwibWVzc2FnZUJveCIsIm1lc3NhZ2VCb3hUZXh0IiwiZm9ybSIsInRpbWVvdXRJZCIsImUiLCJ2YWxpZGF0ZUxvZ2luIiwiY2xlYXJUaW1lb3V0IiwiZXJyb3IiLCJyYWRpbyIsImJ0biIsImJveCIsImxpbWl0cyIsInBhc3NUcmltIiwicmVnIiwiZmlsdGVyZWQiLCJuYW1lIiwidmFsdWUiLCJ0cmltIiwicmVqIiwiY29uY2F0IiwibWluIiwicGFzcyIsImNoZWNrZWQiLCJ2YWxpZGF0ZVBhc3MiLCJ2YWxpZGF0ZUNoZWNrYm94IiwidmFsaWRhdGVSYWRpbyJdLCJtYXBwaW5ncyI6IkFBQUEsYUFDQSxDQUFBLFdBQ0MsSUFxQk9BLEVBdUVGQyxFQTVGTEMsRUFBWUMsU0FBQUMsY0FBQSxZQUFBLEVBQ0xGLEVBQVlDLFNBQVNDLGNBQWMsZUFBYSxFQUNoREMsRUFBY0YsU0FBU0MsY0FBYyxrQkFBZ0IsRUFHckRFLEVBQWEsQ0FBQSwyQ0FDYkMsRUFBYSxDQUFBLDZCQUNiQyxFQUNKLENBSUYsMENBQ0EsdUNBT0FDLEVBQVNDLEVBQ1BDLEVBQVMsRUFFVFgsRUFQQSxDQUFDWSxFQVFPLEdBQUUsTUFBQUMsT0FBQUMsV0FDUkMsR0FBQUEsT0FBQUEsRUFBZ0JKLEVBQU9ILENBQUEsRUFBQVEsT0FDdkJYLEVBQVlZLE9BSkMsRUFxQ2pCLFNBWUlkLElBWEYsTUFDRSxpRUFZVWUsS0FDUkgsVUFBQUEsU0FBZ0JKLEdBQ2IsaUJBQUVSLFNBQUFnQixlQVZYLENBNEJBLFNBZUlKLEVBQUFLLEdBZEYsSUFlRUMsRUFBS0MsU0FBWWIsY0FBUSxtQkFBQSxFQUN4QmMsRUFBSyxJQUFBSCxFQUFBSSxFQUlGQyxFQUFRQyxLQUFHdkIsTUFIbkIsR0FHNEJDLENBQWMsRUFFbEN1QixHQUVOQyxjQUFnQkMsQ0FBSSxFQUVwQkosRUFBUUssWUFBV0QsV0FHREUsSUFGcEJ0QixHQVJTdUIsS0FXSkMsY0FBU0MsQ0FBVSxFQUN0QkMsRUFBV0osR0FFVDdCLEVBQUFBLFVBQVVlLENBQ1osRUFBR00sQ0FBSSxDQUNULENBTkEsU0FtQkVFLElBWEosSUFDQ0EsRUFDT0EsRUFDQVcsRUFTSkgsU0FBQUMsU0FBQSxFQUFBRyxTQUFBLE1BQUEsSUFYSFosRUFBWXRCLFNB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RUE4QlYsSUFBSTZCLFFBQVEsU0FBQ0ssRUFBS3VDLEdBQ3ZCLE9BQU9SLEVBQUlZLFFBQVUzQyxFQUFHLEVBQUt1QyxFQUFJLHdCQUF3QixDQUMzRCxDQUFDLElBR29CVCxFQWxDSEQsRUFtQ1gsSUFBSWxDLFFBQVEsU0FBQ0ssRUFBS3VDLEdBQ3ZCLE9BQU9ULEVBQUlhLFFBQVUzQyxFQUFHLEVBQUt1QyxFQUFJLHdCQUF3QixDQUMzRCxDQUFDLEdBakVBLEVBOEJHcEMsS0FBQSxXQUNKd0IsYUFBQUgsQ0FBQSxFQUVGSCxFQUFTSyxVQUFrQmpCLE9BQUMsb0JBQUEsRUFDcEJnQyxXQUFPLFdBQ1BQLEVBQU0vRCxVQUFnQixtQkFDdEJnRSxFQUFXQyxVQUFXMUQsSUFBQSxvQkFBQSxFQUU1QjZDLEVBQVc1QixNQUFBQSxDQUNULEVBQUEsR0FBT3VDLEVBR1BsRCxXQUFBLFdBQ0pxQyxFQUFBdkQsVUFBQTJDLE9BQUEsb0JBQUEsQ0FFQSxFQUFTbUMsR0FBQUEsQ0FDUCxDQUFBLEVBQU1aLE1BQ0ZDLFNBQUFBLEdBRUdULEdBT1RHLGFBQVNrQixDQUFvQixFQUMzQnhCLEVBQVcxQixVQUFRYyxPQUFNOEIsb0JBQVEsRUFDL0J2RCxXQUFXMkQsV0FDWHJCLEVBQUFuRCxVQUFBeUQsRUFDSlAsRUFBQXZELFVBQUFZLElBQUEsb0JBQUEsQ0FFQSxFQUFTb0UsR0FBQUEsSUFaTHhCLEVBQWdCekQsVUFBZStELEVBRy9CUCxFQUFBdkQsVUFBQVksSUFBQSxvQkFBQSxHQVlBOEMsRUFBQXhDLFdBQUEsV0FDSnFDLEVBQUF2RCxVQUFBMkMsT0FBQSxvQkFBQSxFQUNFZSxFQUFBLElBdENJLEVBQUcsR0FBSSxDQUNULENBQUMsQ0FDTCxDQUFDLENBb0NGLEVBQUEiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcclxuLy8gcHJlbG9hZGVyXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgY29uc3QgcHJlTG9hZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByZWxvYWRlcicpO1xyXG4gIGNvbnN0IHByZUxvYWRlckJnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByZWxvYWRlci1iZycpO1xyXG4gIGNvbnN0IGNvbnRhaW5lckluZGV4ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRhaW5lci1pbmRleCcpO1xyXG5cclxuICBjb25zdCBsb2FkZXJVcmwgPSBbJy4vYXNzZXRzL2ltZy9jb250ZW50L2ZvcmVzdF9wcmVsX2JnLmpwZyddO1xyXG4gIGNvbnN0IHNjcmlwdFVybCA9IFsnLi9hc3NldHMvanMvZm91bmRhdGlvbi5qcyddO1xyXG4gIGNvbnN0IHBhZ2VJbWdVcmxzID0gW1xyXG4gICAgJy4vYXNzZXRzL2ltZy9jb250ZW50L2JnX2ZvcmVzdF8xODAwLmpwZycsXHJcbiAgICAnLi9hc3NldHMvaW1nL2NvbnRlbnQvd2F0ZXItbWFwcy5qcGcnLFxyXG4gIF07XHJcblxyXG4gIGxldCBwcm9ncmVzcyA9IDA7XHJcbiAgbGV0IGxvYWRlZCA9IDA7XHJcbiAgbGV0IGltZ0Zyb21Dc3MgPSAxO1xyXG4gIGxldCBtYXhMb2FkZWQgPVxyXG4gICAgIWlzTW9iaWxlKCkgJiYgd2luZG93LmlubmVyV2lkdGggPj0gMTIwMFxyXG4gICAgICA/IFsuLi5sb2FkZXJVcmwsIC4uLnNjcmlwdFVybCwgLi4ucGFnZUltZ1VybHNdLmxlbmd0aFxyXG4gICAgICA6IGxvYWRlclVybC5sZW5ndGggKyBpbWdGcm9tQ3NzO1xyXG5cclxuICBmdW5jdGlvbiBjaGVja0xvYWRpbmdCZ1ByZWxvYWRlcih1cmwpIHtcclxuICAgIGxldCBpbWFnZSA9IG5ldyBJbWFnZSgpO1xyXG4gICAgaW1hZ2Uuc3JjID0gdXJsWzBdO1xyXG4gICAgaW1hZ2Uub25sb2FkID0gKCkgPT4ge1xyXG4gICAgICBsb2FkZWQrKztcclxuICAgICAgYW5pbWF0ZVByb2dyZXNzKGxvYWRlZCk7XHJcbiAgICAgIHByZUxvYWRlckJnLmNsYXNzTGlzdC5hZGQoJ3ByZWxvYWRlci1iZ192aXNpYmxlJyk7XHJcblxyXG4gICAgICBpZiAoIWlzTW9iaWxlKCkgJiYgd2luZG93LmlubmVyV2lkdGggPj0gMTIwMCkge1xyXG4gICAgICAgIFByb21pc2UuYWxsKHNjcmlwdFVybC5tYXAoKHVybCkgPT4gbG9hZFNjcmlwdCh1cmwpKSlcclxuICAgICAgICAgIC50aGVuKCgpID0+IFByb21pc2UuYWxsKHBhZ2VJbWdVcmxzLm1hcCgodXJsKSA9PiBsb2FkSW1nKHVybCkpKSlcclxuICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgaWYgKGxvYWRlZCA9PT0gbWF4TG9hZGVkKSB7XHJcbiAgICAgICAgICAgICAgY29udGFpbmVySW5kZXguY2xhc3NMaXN0LnJlbW92ZSgnYmctZm9yZXN0LWluZGV4Jyk7XHJcbiAgICAgICAgICAgICAgc2hvd1BhZ2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IGJnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJnLWZvcmVzdC1pbmRleCcpO1xyXG4gICAgICAgIGNvbnN0IGZpcnN0SXRlbSA9ICd1cmwoXCInO1xyXG4gICAgICAgIGNvbnN0IGxhc3RJdGVtID0gJ1wiKSc7XHJcblxyXG4gICAgICAgIGxldCBiZ1N0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoYmcpLmJhY2tncm91bmRJbWFnZTtcclxuICAgICAgICBsZXQgaW5kZXggPSBiZ1N0eWxlLmluZGV4T2YoZmlyc3RJdGVtKSArIGZpcnN0SXRlbS5sZW5ndGg7XHJcblxyXG4gICAgICAgIC8vIHNldE1vYmlsZUZ1bGxIZWlnaHQoYm9keSk7XHJcblxyXG4gICAgICAgIGxldCBpbWFnZSA9IG5ldyBJbWFnZSgpO1xyXG4gICAgICAgIGltYWdlLnNyYyA9IGJnU3R5bGUuc2xpY2UoaW5kZXgsIC1sYXN0SXRlbS5sZW5ndGgpO1xyXG4gICAgICAgIGltYWdlLm9ubG9hZCA9ICgpID0+IHtcclxuICAgICAgICAgIGxvYWRlZCsrO1xyXG4gICAgICAgICAgYW5pbWF0ZVByb2dyZXNzKGxvYWRlZCk7XHJcbiAgICAgICAgICBzaG93UGFnZSgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfVxyXG4gIGNoZWNrTG9hZGluZ0JnUHJlbG9hZGVyKGxvYWRlclVybCk7XHJcblxyXG4gIGZ1bmN0aW9uIGlzTW9iaWxlKCkge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxCbGFja0JlcnJ5fElFTW9iaWxlfE9wZXJhIE1pbmkvaS50ZXN0KFxyXG4gICAgICAgIG5hdmlnYXRvci51c2VyQWdlbnRcclxuICAgICAgKSB8fCAnb250b3VjaHN0YXJ0JyBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnRcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBsb2FkU2NyaXB0KHNjcmlwdCkge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXMpID0+IHtcclxuICAgICAgbGV0IGVsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcclxuICAgICAgZWxlbS5zcmMgPSBzY3JpcHQ7XHJcbiAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kKGVsZW0pO1xyXG4gICAgICBlbGVtLm9ubG9hZCA9ICgpID0+IHtcclxuICAgICAgICBsb2FkZWQrKztcclxuICAgICAgICBhbmltYXRlUHJvZ3Jlc3MobG9hZGVkKTtcclxuICAgICAgICByZXMoKTtcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gbG9hZEltZyh1cmwpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzKSA9PiB7XHJcbiAgICAgIGxldCBpbWcgPSBuZXcgSW1hZ2UoKTtcclxuICAgICAgaW1nLnNyYyA9IHVybDtcclxuICAgICAgaW1nLm9ubG9hZCA9ICgpID0+IHtcclxuICAgICAgICBsb2FkZWQrKztcclxuICAgICAgICBhbmltYXRlUHJvZ3Jlc3MobG9hZGVkKTtcclxuICAgICAgICByZXMoKTtcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbGV0IGludElkO1xyXG4gIGZ1bmN0aW9uIGFuaW1hdGVQcm9ncmVzcyhjb3VudCkge1xyXG4gICAgbGV0IGVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZ3Jlc3NfX251bWJlcicpO1xyXG4gICAgbGV0IG5ld051bWJlciA9ICgxMDAgKiBjb3VudCkgLyBtYXhMb2FkZWQ7XHJcbiAgICBjb25zdCBpbnRlcnZhbCA9IDEwO1xyXG4gICAgY29uc3Qgc3RlcCA9IDE7XHJcbiAgICBjb25zdCB0aW1lID0gTWF0aC5yb3VuZChpbnRlcnZhbCAvIG1heExvYWRlZCk7XHJcblxyXG4gICAgaWYgKGludElkKSB7XHJcbiAgICAgIGNsZWFySW50ZXJ2YWwoaW50SWQpO1xyXG4gICAgfVxyXG4gICAgaW50SWQgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICAgIHByb2dyZXNzICs9IHN0ZXA7XHJcbiAgICAgIGlmIChwcm9ncmVzcyA+PSBuZXdOdW1iZXIpIHtcclxuICAgICAgICBjbGVhckludGVydmFsKGludElkKTtcclxuICAgICAgICBwcm9ncmVzcyA9IG5ld051bWJlcjtcclxuICAgICAgfVxyXG4gICAgICBlbGVtLmlubmVySFRNTCA9IHByb2dyZXNzO1xyXG4gICAgfSwgdGltZSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBvcGVuQXV0aFBhZ2UoKXtcclxuICAgIGNvbnN0IGF1dGhXcmFwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmF1dGgtd3JhcCcpO1xyXG4gICAgY29uc3QgZnJvbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZnJvbnQnKTtcclxuICAgIGNvbnN0IGJhY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYmFjaycpO1xyXG5cclxuICAgIGZyb250LmNsYXNzTGlzdC5hZGQoJ2Zyb250X2ZsaXBwZWQnKTtcclxuICAgIGJhY2suY2xhc3NMaXN0LmFkZCgnYmFja19mbGlwcGVkJyk7XHJcbiAgICBhdXRoV3JhcC5jbGFzc0xpc3QuYWRkKCdhdXRoLXdyYXBfZGlzcGxheS1ub25lJyk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBzaG93UGFnZSgpIHtcclxuICAgIGlmKGxvY2F0aW9uLnRvU3RyaW5nKCkuaW5jbHVkZXMoJ2F1dGgnKSkgb3BlbkF1dGhQYWdlKCk7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgY29udGFpbmVySW5kZXguY2xhc3NMaXN0LmFkZCgnY29udGFpbmVyLWluZGV4X3Zpc2libGUnKTtcclxuICAgICAgcHJlTG9hZGVyLmNsYXNzTGlzdC5hZGQoJ3ByZWxvYWRlcl9oaWRlZCcpO1xyXG4gICAgfSwgMTAwMCk7XHJcbiAgfVxyXG59KSgpO1xyXG4vLyBmbGlwIGZvcm1cclxuKGZ1bmN0aW9uICgpIHtcclxuICBjb25zdCBhdXRoV3JhcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hdXRoLXdyYXAnKTtcclxuICBjb25zdCBhdXRoTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hdXRoX19saW5rJyk7XHJcbiAgY29uc3QgZnJvbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZnJvbnQnKTtcclxuICBjb25zdCBiYWNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJhY2snKTtcclxuICBjb25zdCBob21lTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idXR0X19saW5rX2hvbWUnKTtcclxuXHJcbiAgYXV0aExpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICBmcm9udC5jbGFzc0xpc3QuYWRkKCdmcm9udF9mbGlwcGVkJyk7XHJcbiAgICBiYWNrLmNsYXNzTGlzdC5hZGQoJ2JhY2tfZmxpcHBlZCcpO1xyXG4gICAgYXV0aFdyYXAuY2xhc3NMaXN0LmFkZCgnYXV0aC13cmFwX2Rpc3BsYXktbm9uZScpO1xyXG4gIH0pO1xyXG4gIGhvbWVMaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGZyb250LmNsYXNzTGlzdC5yZW1vdmUoJ2Zyb250X2ZsaXBwZWQnKTtcclxuICAgIGJhY2suY2xhc3NMaXN0LnJlbW92ZSgnYmFja19mbGlwcGVkJyk7XHJcbiAgICBhdXRoV3JhcC5jbGFzc0xpc3QucmVtb3ZlKCdhdXRoLXdyYXBfZGlzcGxheS1ub25lJyk7XHJcbiAgfSk7XHJcbn0pKCk7XHJcbi8vIGZvcm0gYXV0aFxyXG4oZnVuY3Rpb24gKCkge1xyXG4gIGNvbnN0IGxvZ2luTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idXR0X19saW5rX2xvZ2luJyk7XHJcbiAgY29uc3QgZm9ybU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9ybV9fbmFtZScpO1xyXG4gIGNvbnN0IGZvcm1QYXNzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm1fX3Bhc3MnKTtcclxuICBjb25zdCBjaGVja2JveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGVja2JveF9faW5wdXQnKTtcclxuICBjb25zdCByYWRpbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yYWRpby1idG5fX2lucHV0X3llcycpO1xyXG4gIGNvbnN0IG1lc3NhZ2VCb3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZUJveCcpO1xyXG4gIGNvbnN0IG1lc3NhZ2VCb3hUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1lc3NhZ2VCb3hfX3RleHQnKTtcclxuICBsZXQgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtLWF1dGgnKTtcclxuICBsZXQgdGltZW91dElkO1xyXG5cclxuICBsb2dpbkxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIFByb21pc2UuYWxsKFtcclxuICAgICAgdmFsaWRhdGVMb2dpbihmb3JtTmFtZS52YWx1ZSksXHJcbiAgICAgIHZhbGlkYXRlUGFzcyhmb3JtUGFzcy52YWx1ZSksXHJcbiAgICAgIHZhbGlkYXRlQ2hlY2tib3goY2hlY2tib3gpLFxyXG4gICAgICB2YWxpZGF0ZVJhZGlvKHJhZGlvKSxcclxuICAgIF0pXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcclxuICAgICAgICBtZXNzYWdlQm94LmNsYXNzTGlzdC5yZW1vdmUoJ21lc3NhZ2VCb3hfdmlzaWJsZScpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgbWVzc2FnZUJveFRleHQuaW5uZXJIVE1MID0gJ9Ck0L7RgNC80LAg0L7RgtC/0YDQsNCy0LvQtdC90LAnO1xyXG4gICAgICAgICAgbWVzc2FnZUJveC5jbGFzc0xpc3QuYWRkKCdtZXNzYWdlQm94X3Zpc2libGUnKTtcclxuICAgICAgICAgIGZvcm0ucmVzZXQoKTtcclxuICAgICAgICB9LCA4MDApO1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgbWVzc2FnZUJveC5jbGFzc0xpc3QucmVtb3ZlKCdtZXNzYWdlQm94X3Zpc2libGUnKTtcclxuICAgICAgICB9LCAzMDAwKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgIGlmICghdGltZW91dElkKSB7XHJcbiAgICAgICAgICBtZXNzYWdlQm94VGV4dC5pbm5lckhUTUwgPSBlcnJvcjtcclxuICAgICAgICAgIG1lc3NhZ2VCb3guY2xhc3NMaXN0LmFkZCgnbWVzc2FnZUJveF92aXNpYmxlJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xyXG4gICAgICAgICAgbWVzc2FnZUJveC5jbGFzc0xpc3QucmVtb3ZlKCdtZXNzYWdlQm94X3Zpc2libGUnKTtcclxuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBtZXNzYWdlQm94VGV4dC5pbm5lckhUTUwgPSBlcnJvcjtcclxuICAgICAgICAgICAgbWVzc2FnZUJveC5jbGFzc0xpc3QuYWRkKCdtZXNzYWdlQm94X3Zpc2libGUnKTtcclxuICAgICAgICAgIH0sIDgwMCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgIG1lc3NhZ2VCb3guY2xhc3NMaXN0LnJlbW92ZSgnbWVzc2FnZUJveF92aXNpYmxlJyk7XHJcbiAgICAgICAgICB0aW1lb3V0SWQgPSBudWxsO1xyXG4gICAgICAgIH0sIDMwMDApO1xyXG4gICAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZnVuY3Rpb24gdmFsaWRhdGVMb2dpbihuYW1lKXtcclxuICAgIGNvbnN0IG1pbiA9IDI7XHJcbiAgICBjb25zdCByZWcgPSAvXlthLXpBLVowLTldKyQvO1xyXG4gICAgY29uc3QgZmlsdGVyZWQgPSBuYW1lLnRyaW0oKTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlcywgcmVqKSA9PiB7XHJcbiAgICAgIHJldHVybiByZWcudGVzdChmaWx0ZXJlZCkgJiYgZmlsdGVyZWQubGVuZ3RoID4gbWluIFxyXG4gICAgICAgID8gcmVzKGZpbHRlcmVkKVxyXG4gICAgICAgIDogcmVqKGDQktCy0LXQtNC40YLQtSDQu9C+0LPQuNC9INC00LvQuNC90L7QuSDQvtGCICR7bWluKzF9INGB0LjQvNCy0L7Qu9C+0LJgKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gdmFsaWRhdGVQYXNzKHBhc3MpIHtcclxuICAgIGNvbnN0IGxpbWl0cyA9IFs0LCAxNV07XHJcbiAgICBsZXQgcGFzc1RyaW0gPSBwYXNzLnRyaW0oKTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlcywgcmVqKSA9PiB7XHJcbiAgICAgIHJldHVybiBwYXNzVHJpbS5sZW5ndGggPiBsaW1pdHNbMF0gJiYgcGFzc1RyaW0ubGVuZ3RoIDw9IGxpbWl0c1sxXVxyXG4gICAgICAgID8gcmVzKHBhc3NUcmltKVxyXG4gICAgICAgIDogcmVqKGDQktCy0LXQtNC40YLQtSDQv9Cw0YDQvtC70Ywg0LTQu9C40L3QvtC5INC+0YIgJHtsaW1pdHNbMF0rMX0g0LTQviAke2xpbWl0c1sxXX0g0YHQuNC80LLQvtC70L7QsmApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiB2YWxpZGF0ZUNoZWNrYm94KGJveCkge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXMsIHJlaikgPT4ge1xyXG4gICAgICByZXR1cm4gYm94LmNoZWNrZWQgPyByZXMoKSA6IHJlaign0KDQvtCx0L7RgtCw0Lwg0LLRhdC+0LQg0LLQvtGB0L/RgNC10YnQtdC9Jyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHZhbGlkYXRlUmFkaW8oYnRuKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlcywgcmVqKSA9PiB7XHJcbiAgICAgIHJldHVybiBidG4uY2hlY2tlZCA/IHJlcygpIDogcmVqKCfQoNC+0LHQvtGC0LDQvCDQstGF0L7QtCDQstC+0YHQv9GA0LXRidC10L0nKTtcclxuICAgIH0pO1xyXG4gIH1cclxufSkoKTtcclxuIl19
